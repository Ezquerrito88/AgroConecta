<section class="hero-banner">
  <div class="banner-content">
    <div class="badge-fresco">
      <span class="emoji">üå±</span> Cosecha Fresca Diaria
    </div>
    <h1 class="main-title">
      Sabores que <span class="text-green">Conectan</span>
    </h1>
    <p class="main-subtitle">
      Descubre productos √∫nicos directamente de la mano de quienes los cultivan con amor.
    </p>
    <div class="benefits-row">
      <div class="pill"><span class="dot dot-green"></span> Entrega en 48h</div>
      <div class="pill"><span class="dot dot-orange"></span> Directo del campo</div>
      <div class="pill"><span class="dot dot-blue"></span> Precios justos</div>
    </div>
  </div>
</section>

<section class="products-section">
  <div class="category-pills">
    <button class="cat-btn active">Todo</button>
    <button class="cat-btn">Frutas</button>
    <button class="cat-btn">Verduras</button>
    <button class="cat-btn">Granos</button>
    <button class="cat-btn">L√°cteos</button>
    <button class="cat-btn">Especias</button>
  </div>

  <div class="main-layout">
    <aside class="filter-card">
      <div class="filter-header">
        <h3>Filtros</h3>
        <i class="fa-solid fa-sliders"></i>
      </div>
      <div class="filter-group filter-blue">
        <label>‚óè Ordenar por</label>
        <select class="custom-select">
          <option>Destacados</option>
          <option>Precio: Menor a Mayor</option>
        </select>
      </div>
      <div class="filter-group filter-orange">
        <label>‚óè Precio M√°ximo</label>
        <input type="range" class="price-range" min="0" max="100">
      </div>
    </aside>

    <main class="products-grid-container">
      <div class="grid-header">
        <h2>Selecci√≥n Fresca del D√≠a</h2>
        <span class="results-count">P√°gina {{ paginaActual }} de {{ totalPaginas }}</span>
      </div>

      <div class="products-grid">
        <div class="product-card" *ngFor="let prod of productos">
          
          <div class="card-image">
            <div class="stock-badge" *ngIf="prod.stock_quantity <= 5" [class.no-stock]="prod.stock_quantity === 0">
               {{ prod.stock_quantity === 0 ? 'Agotado' : '¬°Casi agotado!' }}
            </div>

            <button class="wishlist-btn" [class.active]="prod.fav" (click)="toggleFavorite(prod)">
              <i [class]="prod.fav ? 'fa-solid fa-heart' : 'fa-regular fa-heart'"></i>
            </button>

            <img *ngIf="prod.images && prod.images.length > 0"
                 [src]="'http://127.0.0.1:8000/storage/' + prod.images[0].image_path" 
                 alt="{{ prod.name }}">
            
            <div *ngIf="!prod.images || prod.images.length === 0" class="placeholder-img">
              <i class="fa-solid fa-image"></i>
            </div>
          </div>

          <div class="card-content">
            <h4 class="product-title">{{ prod.name }}</h4>
            
            <p class="product-desc">{{ prod.description }}</p>

            <div class="seller-box" *ngIf="prod.farmer">
              <span class="seller-name">{{ prod.farmer.full_name || 'Agricultor Local' }}</span>
              <span class="seller-location"><i class="fa-solid fa-location-dot"></i> Logro√±o</span>
            </div>

            <div class="card-footer">
              <div class="price-box">
                <span class="price-main">{{ prod.price }}‚Ç¨</span>
                <span class="price-unit">/{{ prod.unit }}</span>
              </div>
              <button class="add-button" [disabled]="prod.stock_quantity === 0">
                <i class="fa-solid fa-plus"></i> A√±adir
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="pagination-container" *ngIf="totalPaginas > 1">
        <div class="pagination-controls">
          <button type="button" class="pag-btn nav-btn" [disabled]="paginaActual === 1" (click)="cambiarPagina(paginaActual - 1)">
            <i class="fa-solid fa-chevron-left"></i>
          </button>

          <button type="button" class="pag-btn num-btn" [class.active]="paginaActual === 1" (click)="cambiarPagina(1)">1</button>
          <button type="button" class="pag-btn num-btn" *ngIf="totalPaginas >= 2" [class.active]="paginaActual === 2" (click)="cambiarPagina(2)">2</button>

          <button type="button" class="pag-btn nav-btn" [disabled]="paginaActual === totalPaginas" (click)="cambiarPagina(paginaActual + 1)">
            <i class="fa-solid fa-chevron-right"></i>
          </button>
        </div>
      </div>

      <div style="text-align: center; margin-top: 30px;">
        <button type="button" class="btn-full-catalog" (click)="irAlCatalogoCompleto()">
          Ver Cat√°logo Completo
        </button>
      </div>
    </main>
  </div>
</section>